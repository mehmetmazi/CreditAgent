#!/usr/bin/env bash
# Simple wrapper to run claude_test.py inside the project's .venv
# Usage: ./claude [args]

REPO_ROOT="/Users/mehmet/PycharmProjects/CreditAgent"
VENV="$REPO_ROOT/.venv"

# If a local .env file exists in the repo root, load it without exporting other files
# (use set -o allexport so variables in .env become environment variables)
if [ -f "$REPO_ROOT/.env" ]; then
  # shellcheck disable=SC1091
  set -o allexport
  # shellcheck disable=SC1090
  source "$REPO_ROOT/.env"
  set +o allexport
fi

if [ -f "$VENV/bin/activate" ]; then
  # shellcheck disable=SC1090
  source "$VENV/bin/activate"
fi

# Informative check: don't print the key; just warn if it's missing
if [ -z "$ANTHROPIC_API_KEY" ]; then
  echo "Warning: ANTHROPIC_API_KEY is not set. Set it in your shell or create a .env file in the project root with ANTHROPIC_API_KEY=your_key"
  echo "Example (zsh): export ANTHROPIC_API_KEY=\"sk-...\""
  echo "This wrapper will still run claude_test.py but requests to Anthropic will fail without a key."
fi

python "$REPO_ROOT/claude_test.py" "$@"
